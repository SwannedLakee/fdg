<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Test Page</title>
</head>
<body>

<h1>Test Page</h1>
<p>This is a test page for smooth scrolling to the first match.</p>
<p>This is the first match on the page.</p>
<p>This is the second match on the page.</p>
<p>This is the third match on the page.</p>
<p>This is the fourth match on the page.</p>
<p>This is the fifth match on the page.</p>
<p>This is the sixth match on the page.</p>
<p>This is the seventh match on the page.</p>
<p>This is the eighth match on the page.</p>
<p>This is the ninth match on the page.</p>
<p>This is the tenth match on the page.</p>
<p>This is the eleventh match on the page.</p>
<p>This is the twelfth match on the page.</p>
<p>This is the thirteenth match on the page.</p>
<p>This is the fourteenth match on the page.</p>
<p>This is the fifteenth match on the page.</p>
<p>This is the sixteenth match on the page.</p>
<p>This is the seventeenth match on the page.</p>
<p>This is the eighteenth match on the page.</p>
<p>This is the nineteenth match on the page.</p>
<p>This is the twentieth match on the page.</p>
<p>This is the twenty-first match on the page.</p>
<p>This is the twenty-second match on the page.</p>
<p>This is the twenty-third match on the page.</p>
<p>This is the twenty-fourth match on the page.</p>
<p>This is the twenty-fifth match on the page.</p>
<p>This is the twenty-sixth match on the page.</p>
<p>This is the twenty-seventh match on the page.</p>
<p>This is the twenty-eighth match on the page.</p>
<p>This is the twenty-ninth match on the page.</p>
<p>This is the thirtieth match on the page.</p>
<p>This is the thirty-first match on the page.</p>
<p>This is the thirty-second match on the page.</p>
<p>This is the thirty-third match on the page.</p>
<p>This is the thirty-fourth match on the page.</p>
<p>This is the thirty-fifth match on the page.</p>
<p>This is the thirty-sixth match on the page.</p>
<p>This is the thirty-seventh match on the page.</p>
<p>This is the thirty-eighth match on the page.</p>
<p>This is the thirty-ninth match on the page.</p>
<p>This is the fortieth match on the page.</p>
<p>This is the forty-first match on the page.</p>
<p>This is the forty-second match on the page.</p>
<p>This is the forty-third match on the page.</p>
<p>This is the forty-fourth match on the page.</p>
<p>This is the forty-fifth match on the page.</p>
<p>This is the forty-sixth match on the page.</p>
<p>This is the forty-seventh match on the page.</p>
<p>This is the forty-eighth match on the page.</p>
<p>This is the forty-ninth match on the page.</p>
<p>This is the fiftieth match on the page.</p>
</body>
<script>
document.addEventListener("DOMContentLoaded", function() {
    console.log("DOMContentLoaded event fired");
    let params = new URLSearchParams(document.location.search);
    let finder = params.get("s");
    let query = params.get("q");
    let url = document.location.href;

    if (finder && finder.trim() !== "" && query && url.indexOf("#") === -1) {
        console.log("Parameters 's', 'q', and no anchor found in URL");

        let regex = new RegExp(finder, 'gi');
        let textNodes = document.evaluate(
            "//text()[normalize-space(parent::*) != '']", 
            document.body, 
            null, 
            XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE, 
            null
        );

        for (let i = 0; i < textNodes.snapshotLength; i++) {
            let currentNode = textNodes.snapshotItem(i);
            if (regex.test(currentNode.nodeValue)) {
                console.log("Found match in text node:", currentNode.nodeValue);

                let parentNode = currentNode.parentNode;
                parentNode.scrollIntoView({
                    behavior: "smooth",
                    block: "start"
                });

                break; // Прекратить поиск после первого совпадения
            }
        }
    } else {
        console.log("Conditions not met: 's' parameter empty or missing, 'q' parameter empty or missing, or anchor found in URL");
    }
});
</script>
</html>
