<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Cache-control" content="public">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>sc.Dhamma.gift</title>
    <meta property="og:locale" content="en_US" />
    <meta property="og:type" content="article" />
 <!--   <script>  var link = document.createElement('meta');  link.setAttribute('property', 'og:title');  link.content = document.title;  document.getElementsByTagName('head')[0].appendChild(link);</script> -->   
  <meta property="og:title" content="sc.Dhamma.gift" />
 <meta property="og:description" content="Read texts in Pali, with various translations." />
    <meta property="og:site_name" content="sc.Dhamma.gift" />
    <meta property="og:image" itemprop="image"
        content="/favicon.png" />
        
<meta property="og:url" content="/sc" />
<link rel="icon" type="image/png" sizes="32x32" href="https://find.dhamma.gift/assets/img/favico_black.png">     

<link href="/assets/css/styles.css" rel="stylesheet" />

<link href="/assets/css/jquery-ui.min.css" rel="stylesheet"/> 
<link href="/assets/css/extrastyles.css" rel="stylesheet" />
    <link rel="stylesheet" href="thai.css">
<link rel="stylesheet" href="uiextra.css">
<link href="/assets/css/paliLookup.css" rel="stylesheet" />


<script src="/assets/js/jquery-3.7.0.min.js"></script>
<script src="/assets/js/jquery-ui.min.js"></script>
<script src="/assets/js/audioLazyLoad.js"></script>
<!--<script src="https://cdn.jsdelivr.net/gh/virtualvinodh/aksharamukha/aksharamukha-web-plugin/aksharamukha-v3.js?class=pli-lang"></script>-->

</head>

<body class="dark">
    <form id="form" class="ui-widget">
		<label class="sr-only dropup rounded-pill mb-2" for="paliauto"></label>

      <input class="mb-2" id="paliauto" type="search" placeholder="Try sn56.11"><input class="go-button mb-2" type="submit" value="Go">

    <div style="margin-top: 5px;" id="form-div">
       <a href="/ru/read.php" title="Sutta and Vinaya reading" rel="noreferrer">   
        <div id="home-button" class="icon-button">
    <img class="common-size-icon" src="/assets/svg/home-icon.svg"></img>   
        </div>
       </a>
       <div id="fdg-button" class="icon-button">
           <a  href="/ru" title="Sutta and Vinaya search" rel="noreferrer"
            ><img width="26px" alt="find.dhamma.gift icon" src="/assets/img/gray-white.png"></a>
      </div>
        <div id="theme-button" class="icon-button">
<img src="/assets/svg/circle-half-stroke.svg" onclick="switchIcon(this)" class="common-size-icon3 changesvg gray-icon"></img>
 </div>
<!-- Переключатель режимов 1 2 колонки -->
<div id="mode-switcher" class="">
<a id="toggle-mode" href="javascript:void(0);" class="toggle-icon">
  <img src="/assets/svg/align-left.svg" alt="Текст в одно или две колонки" class="common-size-icon4"></img>
</a>
</div>

 <a alt="Настройки"  id="settingsButton" href="javascript:void(0);" class="toggle-icon text-decoration-none text-muted">
  <img id="gear" src="/assets/svg/gear.svg" class="common-size-icon4"></img>
  </a>  
<div class="" >
  <a alt="Помощь"  id="helpMessage" href="javascript:void(0);" class="toggle-icon text-decoration-none text-muted">
  <img id="MenuRead"  src="/assets/svg/question.svg" class="common-size-icon4"></img>
  </a>
</div>
    </div>
    </form>
    <br>
    <div id="navigation" class="navigation">
        <div id="previous"></div>
        <div id="next"></div>
    </div>
    <br>
    
    <div style="max-width: 450px; display: none; margin: 0 auto;" class="alert alert-secondary alert-dismissible fade show mt-3" role="alert" id="settings">
  <div class="mb-2">
    <h2 style="text-align: center;">Настройки</h2>
    
   <!-- Переключатель вариантов -->
  
    <div class="" id="variants-switcher">
  <a alt="Показать или скрыть варианты из разных версий Канона" id="toggle-variants" href="javascript:void(0);" class="toggle-icon text-decoration-none text-black">
  <img src="/assets/svg/eye.svg" class="common-size-icon4"></img> показать-скрыть различия ms и др вариантов Канона
  </a><a style="text-decoration:none;" href="/assets/texts/abbr.html">Список редакций Канона</a> 
</div>  
<br>
  <a alt="onclick popup dictionary" class="common-size-icon4 toggle-dict-btn">  <img src="/assets/svg/comment.svg" class="dictIcon"></img></a>

 вкл-выкл словарь. Клик по слову (<a href="https://dpdict.net/ru">DPD</a>). 
    <br>
    <br>
    <!-- Дропдаун для выбора системы письма -->
    <label for="script-select">Система письма:</label><br>
	<select class="dropdown droponmain rounded-pill text-muted border-2 border-secondary text-center input-group-append" id="script-select">
      <option value="ISOPali">ISOPali</option>
      <option value="Devanagari">Devanagari</option>
      <option value="Thai">Thai</option>
    </select>
	    <!-- Кнопка "Применить" -->

	<button type="button" class="btn btn-sm btn-secondary rounded-pill" id="apply-button" >Применить</button>
    <br>

<br>
    
    Увидели ошибку? <a href="/ru/#contacts">Написать</a> 
    <br>
    <br>
    <button type="button" class="btn btn-sm btn-secondary rounded-pill" id="reset-button" >Сбросить</button>

    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
  </div>
</div>    

    
    <div class="" id="sutta"> 
    <!-- class=" flip-horizontal reverse-order" -->
    </div>
    <hr>
    <div id="navigation" class="navigation">
        <div id="previous2"></div>
        <div id="next2"></div>
    </div>

    <div class="links-area" style="text-align: center;">
        <a href="../" title="Sutta and Vinaya search" rel="noreferrer"
            ><img width="20px" alt="find.dhamma.gift icon" src="/assets/img/gray.png"></a>
      
<a href="/assets/makelist.html" title="Create Lists" rel="noreferrer">
	<svg fill="#383838" height="20px" width="20px" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
	 viewBox="0 0 487.3 487.3" xml:space="preserve">
<g>
	<g>
		<path d="M487.2,69.7c0,12.9-10.5,23.4-23.4,23.4h-322c-12.9,0-23.4-10.5-23.4-23.4s10.5-23.4,23.4-23.4h322.1
			C476.8,46.4,487.2,56.8,487.2,69.7z M463.9,162.3H141.8c-12.9,0-23.4,10.5-23.4,23.4s10.5,23.4,23.4,23.4h322.1
			c12.9,0,23.4-10.5,23.4-23.4C487.2,172.8,476.8,162.3,463.9,162.3z M463.9,278.3H141.8c-12.9,0-23.4,10.5-23.4,23.4
			s10.5,23.4,23.4,23.4h322.1c12.9,0,23.4-10.5,23.4-23.4C487.2,288.8,476.8,278.3,463.9,278.3z M463.9,394.3H141.8
			c-12.9,0-23.4,10.5-23.4,23.4s10.5,23.4,23.4,23.4h322.1c12.9,0,23.4-10.5,23.4-23.4C487.2,404.8,476.8,394.3,463.9,394.3z
			 M38.9,30.8C17.4,30.8,0,48.2,0,69.7s17.4,39,38.9,39s38.9-17.5,38.9-39S60.4,30.8,38.9,30.8z M38.9,146.8
			C17.4,146.8,0,164.2,0,185.7s17.4,38.9,38.9,38.9s38.9-17.4,38.9-38.9S60.4,146.8,38.9,146.8z M38.9,262.8
			C17.4,262.8,0,280.2,0,301.7s17.4,38.9,38.9,38.9s38.9-17.4,38.9-38.9S60.4,262.8,38.9,262.8z M38.9,378.7
			C17.4,378.7,0,396.1,0,417.6s17.4,38.9,38.9,38.9s38.9-17.4,38.9-38.9C77.8,396.2,60.4,378.7,38.9,378.7z"/>
	</g>
</g>
</svg>		
			</a>
<a href="/assets/diff" title="Compare two suttas" rel="noreferrer"
            ><img width="20px" alt="Diff icon" src="/sc/images/favicon-black.png"></a>
 <a href="/ru/history.php" title="Search Histpry" rel="noreferrer"
            ><img width="20px" alt="History icon" src="/assets/svg/clock-rotate-left.svg"></a>           

<a href="/ru/assets/linebyline.html" class="dynamic-link" title="Create Pali-Russ translation files" rel="noreferrer">
        <img width="20px" alt="JSON Formatter icon" src="/assets/svg/table-columns.svg">
    </a>
  	  <script src="/sc/urlForLbl.js"defer></script>
  	  <script src="/assets/js/paliLookup.js"defer></script>
        <a id="shareOnline" onclick="copyToClipboard()" title="Copy fdg url Suttas" rel="noreferrer" target=""><img
                height="20px" alt="" src="/assets/svg/copy.svg"></a>
      
        <!--        <a id="shareT2SElement" onclick="copyToClipboard(127)" title="Copy t2s url" rel="noreferrer" target=""><img
                height="20px" alt="" src="/assets/svg/solid-copy.svg"></a>     -->   
                
        <a href="https://sutta.readingfaithfully.org" title="Citation Lookup Tool" rel="noreferrer" target="_blank"><img
                width="20px" src="./images/favicon-citaton-helper-black.png" alt="Citation Lookup tool icon"></a>
        <a href="https://index.readingfaithfully.org" title="Search for suttas by name" rel="noreferrer"
            target="_blank"><img width="20px" src="./images/favicon-name-black.png" alt="Sutta Name Search icon"></a>
        <a href="https://ped.readingfaithfully.org" title="A lightweight interface for the PED" rel="noreferrer"
            target="_blank"><img width="20px" src="./images/favicon-ped-black.png"
                alt="SuttaCentral.org Lightweight interface icon"></a>
        <a href="https://dppn.readingfaithfully.org" title="A lightweight interface the Dictionary of Pali Proper Names"
            rel="noreferrer" target="_blank"><img width="20px" src="./images/favicon-dppn-black.png"
                alt="DPPN search icon"></a>
        <a href="https://github.com/o28o/fdg#readme" title="The source code for this site" rel="noreferrer"
            target="_blank"><img width="20px" src="./images/GitHub-Mark-64px-black.png" alt="GitHub icon"></a>
    </div>
    
        <div style="text-align: center;" id="copyrightnote">
<div class="container"> <small><a target="_blank" rel="license" href="/#copyrightnote">Copyright Info</a> &copy; Dhamma.gift 2022</a>-<span id="date"></span></small> <button class="btn btn-secondary text-center installButton" id="" style="display:none;"><?php echo $installpwa;?></button></div>
        </div>    
        <script>
  const now = new Date();
  const formattedDate = now.getFullYear();
  document.getElementById("date").textContent = formattedDate;
</script>       
    <script src="/assets/js/linksdpr.js"></script>
<!--   -->   <script src="/assets/js/switchView.js"></script>

                <script src="/assets/js/linksru.js"></script>
        <script src="/assets/js/openRu.js"></script>
        <script src="/assets/js/linksbw.js"></script>
                <script src="/assets/js/openBw.js"></script>
    <script src="devanagari.js"></script>

	  <script src="/assets/js/smoothScroll.js"defer></script>
    
    <script src="randPlaceholder.js"></script>
    <script>
    var theLanguage = $('html').attr("lang");
      randPlaceholder("en");
    </script>  
<!-- <script src="https://code.responsivevoice.org/responsivevoice.js?key=X8U4dR8x"></script>
 -->
</body>
<!-- <script>

  // Function to reset all form elements
function resetForm() {
  document.getElementById("paliauto").value = "";
  document.getElementById("pOptions").selectedIndex = 0;
  document.getElementById("extraOptions").selectedIndex = 0;
  document.getElementById("onlCheckbox").checked = false;
  document.getElementById("laCheckbox").checked = false;
  // Reset other checkboxes and dropdowns as needed
  checkInput(); // Check input after resetting form
}

// Event listener for the clear button
document.getElementById("clearbtn").addEventListener("click", function() {
  resetForm();
});

// Event listener to submit the form when Enter key is pressed
var input = document.getElementById("paliauto");
input.addEventListener("keypress", function(event) {
  if (event.key === "Enter") {
    event.preventDefault();
    document.getElementById("searchbtn").click();
  }
});

// Получаем кнопки для вставки букв
var buttons = document.querySelectorAll('.insert-letter');

// Добавляем обработчики событий для каждой кнопки
buttons.forEach(function(button) {
  button.addEventListener('click', function(event) {
    event.preventDefault();
    var letterValue = this.getAttribute('data-letter');
    var currentValue = input.value;
    var selectionStart = input.selectionStart;
    var selectionEnd = input.selectionEnd;
    var newValue = currentValue.substring(0, selectionStart) + letterValue + currentValue.substring(selectionEnd);
    input.value = newValue;

    // Перемещаем курсор после вставленных символов
    var newCursorPosition = selectionStart + letterValue.length;
    input.setSelectionRange(newCursorPosition, newCursorPosition);

    // Имитируем событие ввода, чтобы обновить состояние автозаполнения
    var inputEvent = new Event('input', { bubbles: true });
    input.dispatchEvent(inputEvent);

    // Перемещаем фокус на поле ввода
    input.focus();
  });
});

// Получаем чекбоксы и выпадающие списки
var checkboxes = document.querySelectorAll('input[type="checkbox"]');
var selects = document.querySelectorAll('select');

// Добавляем обработчики событий для чекбоксов
checkboxes.forEach(function(checkbox) {
  checkbox.addEventListener('change', checkInput);
});

// Добавляем обработчики событий для выпадающих списков
selects.forEach(function(select) {
  select.addEventListener('change', checkInput);
});

var clearButton = document.getElementById('clearbtn');

// Проверяем поле при загрузке страницы
checkInput();

// Добавляем обработчик события input
input.addEventListener('input', checkInput);

// Очистка поля и скрытие кнопки при клике на кнопку очистки
clearButton.addEventListener('click', function() {
  input.value = '';
  checkInput();
});

function checkInput() {
  if (
    input.value.trim().length > 0 ||
    Array.from(checkboxes).some(function(checkbox) {
      return checkbox.checked;
    }) ||
    Array.from(selects).some(function(select) {
      return select.value !== "";
    })
  ) {
    clearButton.style.display = 'block'; // Показываем кнопку, если есть текст или выбраны чекбоксы/списки
  } else {
    clearButton.style.display = 'none'; // Скрываем кнопку, если нет текста и не выбраны чекбоксы/списки
  }
}

// Поместить курсор в конец строки в поле ввода
input.focus();
input.setSelectionRange(input.value.length, input.value.length);
</script> -->
<script>
$.ajax({
  url: "/assets/texts/sutta_words.txt",
  dataType: "text",
  success: function(data) {

    var accentMap = {
      "ā": "a",
      "ī": "i",
      "ū": "u",
      "ḍ": "d",
      "ḷ": "l",
      "ṁ": "n",
      "ṁ": "m",
      "ṅ": "n",
      "ṇ": "n",
      "ṭ": "t",
      "ñ": "n",
      "ññ": "n",
      "ss": "s",
      "aa": "a",
      "ii": "i",
      "uu": "u",
      "dd": "d",
      "kk": "k",
      "ḍḍ": "d",
      "ḷḷ": "l",
      "ṇṇ": "n",
      "ṭṭ": "t",
      "cc": "c",
      "pp": "p",
	  "cch": "c",
      "ch": "c",
      "kh": "k",
      "ph": "p",
      "th": "t",
      "ṭh": "t"
    };

    var normalize = function(term) {
      var ret = "";
      for (var i = 0; i < term.length; i++) {
          ret += accentMap[term.charAt(i)] || term.charAt(i);
      }
      return ret;
    };

    var allWords = data.split('\n');

    $("#paliauto").autocomplete({
      position: {
        my: "left bottom",
        at: "left top",
        collision: "flip"
      },
      minLength: 0,
      multiple: /[\s\*]/, // изменение регулярного выражения для разделения по пробелу или звездочке
      source: function(request, response) {
        var terms = request.term.split(/[\|\s\*]/); // изменение регулярного выражения для разделения по пробелу или звездочке или |
        var lastTerm = terms.pop().trim();
        var otherMinLength = 3;

        if (lastTerm.length < otherMinLength) {
          response([]);
          return;
        }

        var re = $.ui.autocomplete.escapeRegex(lastTerm);
        var matchbeginonly = new RegExp("^" + re, "i");
        var matchall = new RegExp(re.replace(/([a-z])\1/gi, "$1$1"), "i");

        var listBeginOnly = $.grep(allWords, function(value) {
          value = value.label || value.value || value;
          var results = matchbeginonly.test(value) || matchbeginonly.test(normalize(value));
          return results;
        });

        var listAll = $.grep(allWords, function(value) {
          value = value.label || value.value || value;
          var results = matchall.test(value) || matchall.test(normalize(value));
          return results;
        });

        listAll = listAll.filter(function(el) {
          return !listBeginOnly.includes(el);
        });

        // Ограничение количества подсказок до 10
        var maxRecord = 1000;
        var resultList = listBeginOnly.concat(listAll).slice(0, maxRecord);

        response(resultList);
      },
      focus: function(event, ui) {
        // Удаляем автоматическое введение при наведении мыши
        return false;
      },
      select: function(event, ui) {
  var terms = this.value.split(/([\|\s\*])/);
  terms.pop();
  terms.push(ui.item.value);
  
  for (var i = 1; i < terms.length; i += 2) {
    if (terms[i] === "*") {
      terms[i] = "*";
    } else if (terms[i] === "|") {
      terms[i] = "|";
    } else {
      terms[i] = " ";
    }
  }

  this.value = terms.join("");
  return false;
}

    }).autocomplete("widget").addClass("fixed-height");
  }
});
</script>
<!-- <script>
$(document).ready(function() {
  // Обработчик для нажатия клавиши Enter
  $(document).on('keydown', function(event) {
    if (event.key === 'Enter') {
      $('#collapseSettings').collapse('hide'); // Здесь меняем 'toggle' на 'hide'
     $('#navbarResponsive').collapse('hide');
    }
  });

  // Обработчик для отправки формы
  $('#searchbtn').on('click', function() {
    $('#collapseSettings').collapse('hide'); // Здесь меняем 'toggle' на 'hide'
          $('#navbarResponsive').collapse('hide');
  });
});
</script> -->
<!-- <script src="/assets/js/bootstrap.bundle.5.3.1.min.js"></script> -->
<script defer src="/assets/js/themeswitch.js"></script>
<script src="/assets/js/copyToClipboard.js"></script>
<script>
window.addEventListener("load", function() {
    console.log("Document loaded");

    setTimeout(function() {
        console.log("Timeout fired after 1.5 seconds");

        let params = new URLSearchParams(document.location.search);
        let finder = params.get("s");
        //finder = finder.replace(/\\b/g, '');
        let query = params.get("q");
        let url = document.location.href;

        if (finder && finder.trim() !== "" && query && url.indexOf("#") === -1) {
            console.log("Parameters 's', 'q', and no anchor found in URL");

            let regex = new RegExp(finder, 'gi');
            let textNodes = document.evaluate(
                "//text()[normalize-space(parent::*) != '']", 
                document.body, 
                null, 
                XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE, 
                null
            );

            for (let i = 0; i < textNodes.snapshotLength; i++) {
                let currentNode = textNodes.snapshotItem(i);
                if (regex.test(currentNode.nodeValue)) {
                    console.log("Found match in text node:", currentNode.nodeValue);

                    let parentNode = currentNode.parentNode;
                    parentNode.scrollIntoView({
                        behavior: "smooth",
                        block: "start"
                    });

                    break; // Прекратить поиск после первого совпадения
                }
            }
        } else {
            console.log("Conditions not met: 's' parameter empty or missing, 'q' parameter empty or missing, or anchor found in URL");
        }
    }, 1000); // 1.5 секунды таймаута
});
</script>
<script src="/assets/js/variantsButtonSc.js"></script>
    <script src="/assets/js/showHideHelp.js"></script>

<script src="/assets/js/settings.js"></script>
</html>
